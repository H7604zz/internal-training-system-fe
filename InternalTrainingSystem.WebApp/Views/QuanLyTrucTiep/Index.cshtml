@{
    ViewData["Title"] = "Trang Chủ Quản Lý Trực Tiếp";
}

@section Styles {
    <link rel="stylesheet" href="~/css/quan-ly-truc-tiep.css" />
}

<div class="container-fluid py-4">
    <!-- Welcome Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="page-header">
                <h1 class="page-title">
                    <i class="fas fa-tachometer-alt me-2"></i>
                    Dashboard Quản Lý Trực Tiếp
                </h1>
                <p class="page-subtitle">Tổng quan và quản lý các khóa học đào tạo cho nhân viên</p>
            </div>
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="row mb-4">
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="stats-card primary">
                <div class="stats-content">
                    <div class="stats-number" id="totalCoursesCount">-</div>
                    <div class="stats-label">Khóa Học Sắp Mở</div>
                </div>
                <div class="stats-icon">
                    <i class="fas fa-book-open"></i>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="stats-card success">
                <div class="stats-content">
                    <div class="stats-number" id="pendingStaffCount">-</div>
                    <div class="stats-label">Nhân Viên Chờ Mời</div>
                </div>
                <div class="stats-icon">
                    <i class="fas fa-users-clock"></i>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="stats-card warning">
                <div class="stats-content">
                    <div class="stats-number" id="invitedStaffCount">-</div>
                    <div class="stats-label">Đã Gửi Lời Mời</div>
                </div>
                <div class="stats-icon">
                    <i class="fas fa-paper-plane"></i>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="stats-card info">
                <div class="stats-content">
                    <div class="stats-number" id="confirmedStaffCount">-</div>
                    <div class="stats-label">Đã Xác Nhận</div>
                </div>
                <div class="stats-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="course-list-card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-bolt me-2"></i>
                        Thao Tác Nhanh
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-3 col-md-6 mb-3">
                            <a href="@Url.Action("DanhSachKhoaHocSapMo")" class="quick-action-card">
                                <div class="quick-action-icon bg-primary">
                                    <i class="fas fa-list"></i>
                                </div>
                                <div class="quick-action-content">
                                    <h6>Xem Khóa Học</h6>
                                    <p>Danh sách khóa học sắp mở lớp</p>
                                </div>
                                <div class="quick-action-arrow">
                                    <i class="fas fa-arrow-right"></i>
                                </div>
                            </a>
                        </div>
                        <div class="col-lg-3 col-md-6 mb-3">
                            <a href="@Url.Action("DanhSachKhoaHoc", "Course")" class="quick-action-card">
                                <div class="quick-action-icon bg-success">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="quick-action-content">
                                    <h6>Khóa Học</h6>
                                    <p>Tất cả khóa học có sẵn</p>
                                </div>
                                <div class="quick-action-arrow">
                                    <i class="fas fa-arrow-right"></i>
                                </div>
                            </a>
                        </div>
                        <div class="col-lg-3 col-md-6 mb-3">
                            <a href="@Url.Action("DanhSachLopHoc", "Class")" class="quick-action-card">
                                <div class="quick-action-icon bg-warning">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="quick-action-content">
                                    <h6>Lớp Học</h6>
                                    <p>Quản lý các lớp học</p>
                                </div>
                                <div class="quick-action-arrow">
                                    <i class="fas fa-arrow-right"></i>
                                </div>
                            </a>
                        </div>
                        <div class="col-lg-3 col-md-6 mb-3">
                            <a href="@Url.Action("DanhSachBaiQuiz", "Quiz")" class="quick-action-card">
                                <div class="quick-action-icon bg-info">
                                    <i class="fas fa-clipboard-check"></i>
                                </div>
                                <div class="quick-action-content">
                                    <h6>Bài Kiểm Tra</h6>
                                    <p>Quản lý bài kiểm tra</p>
                                </div>
                                <div class="quick-action-arrow">
                                    <i class="fas fa-arrow-right"></i>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Activities & Progress -->
    <div class="row">
        <div class="col-lg-8 mb-4">
            <div class="course-list-card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-chart-line me-2"></i>
                        Tiến Độ Mời Nhân Viên
                    </h5>
                </div>
                <div class="card-body">
                    <div class="progress-overview">
                        <div class="progress-item">
                            <div class="progress-info">
                                <span class="progress-label">Khóa học C# Programming</span>
                                <span class="progress-value">15/20 nhân viên</span>
                            </div>
                            <div class="progress">
                                <div class="progress-bar bg-success" style="width: 75%"></div>
                            </div>
                        </div>
                        <div class="progress-item">
                            <div class="progress-info">
                                <span class="progress-label">Khóa học Project Management</span>
                                <span class="progress-value">8/15 nhân viên</span>
                            </div>
                            <div class="progress">
                                <div class="progress-bar bg-warning" style="width: 53%"></div>
                            </div>
                        </div>
                        <div class="progress-item">
                            <div class="progress-info">
                                <span class="progress-label">Khóa học Digital Marketing</span>
                                <span class="progress-value">3/12 nhân viên</span>
                            </div>
                            <div class="progress">
                                <div class="progress-bar bg-danger" style="width: 25%"></div>
                            </div>
                        </div>
                        <div class="progress-item">
                            <div class="progress-info">
                                <span class="progress-label">Khóa học Leadership Skills</span>
                                <span class="progress-value">10/10 nhân viên</span>
                            </div>
                            <div class="progress">
                                <div class="progress-bar bg-info" style="width: 100%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4 mb-4">
            <div class="course-list-card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-bell me-2"></i>
                        Thông Báo Gần Đây
                    </h5>
                </div>
                <div class="card-body">
                    <div class="notification-list">
                        <div class="notification-item">
                            <div class="notification-icon bg-success">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="notification-content">
                                <p class="notification-text">Nguyễn Văn A đã xác nhận tham gia khóa học C# Programming</p>
                                <small class="notification-time">2 phút trước</small>
                            </div>
                        </div>
                        <div class="notification-item">
                            <div class="notification-icon bg-warning">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="notification-content">
                                <p class="notification-text">Khóa học Project Management sắp đến hạn mở lớp</p>
                                <small class="notification-time">1 giờ trước</small>
                            </div>
                        </div>
                        <div class="notification-item">
                            <div class="notification-icon bg-info">
                                <i class="fas fa-paper-plane"></i>
                            </div>
                            <div class="notification-content">
                                <p class="notification-text">Đã gửi lời mời cho 5 nhân viên tham gia khóa học Digital Marketing</p>
                                <small class="notification-time">2 giờ trước</small>
                            </div>
                        </div>
                        <div class="notification-item">
                            <div class="notification-icon bg-primary">
                                <i class="fas fa-plus"></i>
                            </div>
                            <div class="notification-content">
                                <p class="notification-text">Khóa học Leadership Skills mới được thêm vào danh sách</p>
                                <small class="notification-time">1 ngày trước</small>
                            </div>
                        </div>
                    </div>
                    <div class="text-center mt-3">
                        <a href="#" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-eye me-1"></i>
                            Xem Tất Cả
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            loadDashboardStats();
            
            // Auto refresh every 5 minutes
            setInterval(loadDashboardStats, 300000);
        });

        function loadDashboardStats() {
            $.get('@Url.Action("GetThongKeTongQuan")')
                .done(function(response) {
                    if (response.success && response.data) {
                        $('#totalCoursesCount').text(response.data.totalCourses || 0);
                        $('#pendingStaffCount').text(response.data.pendingStaff || 0);
                        $('#invitedStaffCount').text(response.data.invitedStaff || 0);
                        $('#confirmedStaffCount').text(response.data.confirmedStaff || 0);
                        
                        // Add loading animation
                        $('.stats-number').addClass('animate__animated animate__fadeIn');
                    }
                })
                .fail(function() {
                    console.log('Không thể tải thống kê dashboard');
                    // Set default values
                    $('#totalCoursesCount').text('0');
                    $('#pendingStaffCount').text('0');
                    $('#invitedStaffCount').text('0');
                    $('#confirmedStaffCount').text('0');
                });
        }
    </script>
}